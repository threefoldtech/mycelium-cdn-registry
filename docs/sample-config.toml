# Sample configuration file for mycdnctl (Hero Redis shard storage)
# Save this as config.toml and modify as needed
#
# Each configured backend receives one shard for every encoded block.
# Reed-Solomon requires:
#   - required_shards (k) >= 1
#   - required_shards (k) <= number of backends (n)
# You can tolerate up to (n - k) backend failures/unavailability.

# Number of shards required to recover the data (minimum)
required_shards = 3

# List of Hero Redis backends to store shards
# One shard is sent to each backend in this list.
#
# mycdnctl will connect to each host, authenticate (optional), SELECT the db, then SET:
#   key   = blake3_16(encrypted_chunk_bytes)   (16 bytes, binary)
#   value = shard bytes                       (binary)
#
# Notes on auth:
# - auth is optional; omit it if your Hero Redis is configured for public read/write.
# - auth.type = "token" uses `AUTH <token>`
# - auth.type = "private_key" performs CHALLENGE/TOKEN/AUTH using the private key
#   (private_key must be 64 hex chars = 32 bytes)

# Region 1: Europe
[[backends]]
kind = "hero_redis"
host = "eu-west.hero-redis.example.com:6379"
db = 7
# auth = { type = "token", token = "your-session-token" }
# auth = { type = "private_key", private_key = "64-hex-chars-private-key-goes-here" }

# Region 2: North America
[[backends]]
kind = "hero_redis"
host = "us-east.hero-redis.example.com:6379"
db = 7

# Region 3: Asia
[[backends]]
kind = "hero_redis"
host = "asia-east.hero-redis.example.com:6379"
db = 7

# Region 4: Australia
[[backends]]
kind = "hero_redis"
host = "au-east.hero-redis.example.com:6379"
db = 7

# Region 5: South America
[[backends]]
kind = "hero_redis"
host = "sa-east.hero-redis.example.com:6379"
db = 7

# Notes:
# 1. The total number of backends (n) should be greater than required_shards (k)
#    to provide redundancy. Example: k=3, n=5 => can lose up to 2 backends.
#
# 2. Distributing Hero Redis instances across regions enables geo-aware shard retrieval
#    in the wider system (if your downloader/CDN selects nearest backends).
#
# 3. Use the same db number across backends unless you have a reason to isolate shards.
#
# 4. Avoid using --include-password in production unless you explicitly want to embed
#    auth tokens into metadata. If metadata is public, embedded tokens effectively grant
#    shard access to anyone who can fetch metadata.
#
# 5. Prefer auth.type="private_key" over embedding tokens in config if you need auth,
#    but keep in mind you are still storing a credential in the config file.
